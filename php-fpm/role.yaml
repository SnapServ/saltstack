php-fpm:
  managed: False

  versions: {}
  repositories: {}

  version_defaults:
    enabled: False
    pools: {}
    
    early_config: {}
    main_config: {}

  pool_defaults:
    pm: 'dynamic'
    pm.max_children: 4
    pm.start_servers: 2
    pm.min_spare_servers: 1
    pm.max_spare_servers: 3

  <os_family>:
    Debian:
      repositories:
        sury-php:
          sources:
            - 'deb https://packages.sury.org/php {{ salt['grains.get']('oscodename')|lower }} main'
          gpg_key_url: 'https://packages.sury.org/php/apt.gpg'

      version_defaults:
        packages:
          - 'php{version:s}-fpm'
          - 'php{version:s}-cli'
        service: 'php{version:s}-fpm'

        base_config_dir: '/etc/php/{version:s}'
        cli_config_dir: '/etc/php/{version:s}/cli/conf.d'
        fpm_config_dir: '/etc/php/{version:s}/fpm/conf.d'
        fpm_pool_dir: '/etc/php/{version:s}/fpm/pool.d'
        fpm_socket_prefix: '/run/php/php{version:s}-fpm-'

      pool_defaults:
        user: 'www-data'
        group: 'www-data'

        listen.owner: 'www-data'
        listen.group: 'www-data'
        listen.mode: '0660'
